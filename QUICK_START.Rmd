# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰

## ğŸ“¦ å®Œå…¨ãªãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

GitHubãƒªãƒã‚¸ãƒˆãƒªã«ä»¥ä¸‹ã®æ§‹æˆã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ãã ã•ã„ï¼š

```         
nlmixr2-handson/
â”œâ”€â”€ .gitignore                   # Gitç®¡ç†å¯¾è±¡å¤–ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ .Rprofile                    # renvè‡ªå‹•æœ‰åŠ¹åŒ– + ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
â”œâ”€â”€ README.md                    # ãƒªãƒã‚¸ãƒˆãƒªã®èª¬æ˜ï¼ˆå‚åŠ è€…å‘ã‘ï¼‰
â”œâ”€â”€ SETUP_GUIDE.md               # è¬›å¸«ç”¨è©³ç´°ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †
â”œâ”€â”€ QUICK_START.md               # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ renv.lock                    # ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
â”œâ”€â”€ presentation.qmd             # ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³‡æ–™ï¼ˆReveal.jsï¼‰
â”œâ”€â”€ handson.qmd                  # ãƒãƒ³ã‚ºã‚ªãƒ³å®Ÿç¿’ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ .gitkeep                # ç©ºãƒ•ã‚©ãƒ«ãƒ€ç¶­æŒç”¨ï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å‰Šé™¤å¯ï¼‰
â”‚   â”œâ”€â”€ pk_data.csv             # â˜… ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå¾Œã«è¿½åŠ 
â”‚   â””â”€â”€ true_parameters.csv     # â˜… ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå¾Œã«è¿½åŠ 
â””â”€â”€ scripts/
    â””â”€â”€ 01_generate_data.R      # ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

------------------------------------------------------------------------

## âš¡ 5ã‚¹ãƒ†ãƒƒãƒ—ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### Step 1: ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒã‚¸ãƒˆãƒªä½œæˆï¼ˆ2åˆ†ï¼‰

``` bash
mkdir nlmixr2-handson
cd nlmixr2-handson
git init
```

### Step 2: ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ï¼ˆ3åˆ†ï¼‰

ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‹ã‚‰æä¾›ã•ã‚ŒãŸä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ï¼š

1.  `.gitignore`
2.  `.Rprofile`
3.  `README.md`
4.  `SETUP_GUIDE.md`
5.  `renv.lock`
6.  `presentation.qmd`
7.  `handson.qmd`
8.  `scripts/01_generate_data.R`

**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ**:

``` bash
mkdir data
mkdir scripts
```

### Step 3: ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ5åˆ†ï¼‰

Rã‚’èµ·å‹•ã—ã¦ï¼š

``` r
# å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
install.packages(c("rxode2", "dplyr", "tidyr"))

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
source("scripts/01_generate_data.R")

# ç¢ºèª
list.files("data/")
# [1] "pk_data.csv"         "true_parameters.csv"
```

`.gitkeep`ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚‚ã—ä½œæˆã—ã¦ã„ãŸå ´åˆï¼‰ã¯å‰Šé™¤ã—ã¦OKã€‚

### Step 4: GitHubã«ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆ3åˆ†ï¼‰

``` bash
# GitHubã§æ–°è¦ãƒªãƒã‚¸ãƒˆãƒªä½œæˆï¼ˆnlmixr2-handsonã€Publicï¼‰

# ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰ãƒ—ãƒƒã‚·ãƒ¥
git add .
git commit -m "Initial commit: Complete handson materials"
git remote add origin https://github.com/YOUR_USERNAME/nlmixr2-handson.git
git branch -M main
git push -u origin main
```

**YOUR_USERNAME**ã‚’è‡ªåˆ†ã®GitHubãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

### Step 5: Posit Cloudãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆï¼ˆ10åˆ†ï¼‰

1.  [posit.cloud](https://posit.cloud)ã«ãƒ­ã‚°ã‚¤ãƒ³
2.  **New Project** â†’ **New Project from Git Repository**
3.  URL: `https://github.com/YOUR_USERNAME/nlmixr2-handson`
4.  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒé–‹ã„ãŸã‚‰ã€Consoleã§ï¼š

``` r
renv::restore()
# å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¾ã§å¾…ã¤ï¼ˆ10-15åˆ†ï¼‰
```

5.  å‹•ä½œç¢ºèªï¼š

``` r
# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
pk_data <- read.csv("data/pk_data.csv")
str(pk_data)

# nlmixr2å‹•ä½œç¢ºèª
library(nlmixr2)
```

6.  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå³ä¸Š **âš™ï¸** â†’ **Access** â†’ **Everyone**ã«è¨­å®š
7.  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆURLã‚’ã‚³ãƒ”ãƒ¼ï¼ˆå‚åŠ è€…ã«å…±æœ‰ï¼‰

------------------------------------------------------------------------

## ğŸ¯ æœ€å°é™ã®ãƒ†ã‚¹ãƒˆæ‰‹é †

æ™‚é–“ãŒãªã„å ´åˆã€ä»¥ä¸‹ã ã‘ç¢ºèªï¼š

``` r
# 1. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸èª­ã¿è¾¼ã¿
library(nlmixr2)
library(rxode2)
library(dplyr)
library(ggplot2)

# 2. ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
pk_data <- read.csv("data/pk_data.csv")

# 3. ç°¡å˜ãªãƒ—ãƒ­ãƒƒãƒˆ
library(ggplot2)
ggplot(pk_data[pk_data$EVID == 0 & pk_data$BLQ == 0, ], 
       aes(x = TIME, y = DV, group = ID)) +
  geom_line() +
  scale_y_log10()

# 4. ç°¡å˜ãªãƒ¢ãƒ‡ãƒ«ãƒ•ã‚£ãƒƒãƒˆï¼ˆ1-cptã€è¿…é€Ÿç‰ˆï¼‰
test_model <- function() {
  ini({ tcl <- log(0.25); tv <- log(3.5); eta.cl ~ 0.1; eta.v ~ 0.1; prop.err <- 0.2 })
  model({ 
    cl <- exp(tcl + eta.cl); v <- exp(tv + eta.v)
    d/dt(central) <- -cl/v * central
    cp <- central/v; cp ~ prop(prop.err) 
  })
}

fit_test <- nlmixr2(test_model, data = pk_data, est = "saem", 
                    control = saemControl(nBurn = 50, nEm = 100, print = 10))
print(fit_test)
```

ã‚¨ãƒ©ãƒ¼ãŒå‡ºãªã‘ã‚Œã°ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ã§ã™ï¼

------------------------------------------------------------------------

## ğŸ“§ å‚åŠ è€…ã¸ã®å…±æœ‰æƒ…å ±ï¼ˆã‚³ãƒ”ãƒšç”¨ï¼‰

### ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```         
ã€nlmixr2ãƒãƒ³ã‚ºã‚ªãƒ³ã€‘ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã®ã”æ¡ˆå†…

ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š

Posit Cloudãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:
https://posit.cloud/content/YOUR_PROJECT_ID

ã¾ãŸã¯

GitHubãƒªãƒã‚¸ãƒˆãƒª:
https://github.com/YOUR_USERNAME/nlmixr2-handson

ã€æ‰‹é †ã€‘
1. ä¸Šè¨˜ãƒªãƒ³ã‚¯ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ï¼ˆGitHubã®å ´åˆï¼‰New Project from Git Repository
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹å¾Œã€Console ã§ renv::restore() å®Ÿè¡Œ
4. handson.qmd ã‚’é–‹ã

å½“æ—¥ãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ï¼
```

------------------------------------------------------------------------

## âš ï¸ ã‚ˆãã‚ã‚‹è³ªå•

### Q: renv.lockã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯æœ€æ–°ã«ã™ã¹ãï¼Ÿ

A: ã„ã„ãˆã€‚æä¾›ã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯**å‹•ä½œç¢ºèªæ¸ˆã¿**ã§ã™ã€‚æœ€æ–°ç‰ˆã§äº’æ›æ€§ã®å•é¡ŒãŒèµ·ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãã®ã¾ã¾ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

### Q: ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«(pk_data.csv)ã‚’GitHubã«ã‚³ãƒŸãƒƒãƒˆã™ã¹ãï¼Ÿ

A: **ã¯ã„**ã€‚å‚åŠ è€…ãŒã™ãã«ä½¿ãˆã‚‹ã‚ˆã†ã€ç”Ÿæˆæ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ãã ã•ã„ã€‚

### Q: ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ã¯HTMLã«äº‹å‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼Ÿ

A: **ä»»æ„**ã§ã™ã€‚å½“æ—¥ãƒ©ã‚¤ãƒ–ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã¦ã‚‚è‰¯ã„ã§ã™ã—ã€äº‹å‰ã«HTMLã‚’ç”Ÿæˆã—ã¦ã‚‚OKã§ã™ã€‚

``` r
# äº‹å‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹å ´åˆ
quarto::quarto_render("presentation.qmd")
```

### Q: handson.qmdã¯HTMLã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã¹ãï¼Ÿ

A: **ä¸è¦**ã§ã™ã€‚å‚åŠ è€…ã¯**ã‚³ãƒ¼ãƒ‰ãƒãƒ£ãƒ³ã‚¯ã‚’å€‹åˆ¥å®Ÿè¡Œ**ã™ã‚‹ãŸã‚ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã¾ã›ã‚“ã€‚

------------------------------------------------------------------------

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "package 'nlmixr2' is not available"

``` r
# CRANãƒŸãƒ©ãƒ¼ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
options(repos = c(CRAN = "https://cloud.r-project.org"))
install.packages("nlmixr2")
```

### ã‚¨ãƒ©ãƒ¼: ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆæ™‚ã«"object 'LLOQ' not found"

â†’ `scripts/01_generate_data.R`ã®å…¨ä½“ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼ˆä¸€éƒ¨ã ã‘å®Ÿè¡Œã™ã‚‹ã¨å¤‰æ•°ãŒå®šç¾©ã•ã‚Œã¾ã›ã‚“ï¼‰

### Posit Cloudã§ "Out of memory"

â†’ ç„¡æ–™ãƒ—ãƒ©ãƒ³ã¯1GBåˆ¶é™ã€‚æœ‰æ–™ãƒ—ãƒ©ãƒ³ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã€ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’å‰Šæ¸›ã—ã¦ãã ã•ã„ã€‚

------------------------------------------------------------------------

## âœ… æœ€çµ‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ã‚»ãƒŸãƒŠãƒ¼å‰æ—¥ã¾ã§ã«ï¼š

-   [ ] GitHubãƒªãƒã‚¸ãƒˆãƒªãŒPublicã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹
-   [ ] data/pk_data.csv ãŒå­˜åœ¨ã™ã‚‹
-   [ ] Posit Cloudãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå‹•ä½œã™ã‚‹
-   [ ] renv::restore()ãŒå®Œäº†ã™ã‚‹
-   [ ] ç°¡å˜ãªãƒ¢ãƒ‡ãƒ«ãƒ•ã‚£ãƒƒãƒˆãŒæˆåŠŸã™ã‚‹
-   [ ] å‚åŠ è€…ã¸ã®æ¡ˆå†…ãƒ¡ãƒ¼ãƒ«ã‚’é€ä»˜æ¸ˆã¿

------------------------------------------------------------------------

**æº–å‚™å®Œäº†ï¼ç´ æ™´ã‚‰ã—ã„ã‚»ãƒŸãƒŠãƒ¼ã«ãªã‚‹ã“ã¨ã‚’ç¥ˆã£ã¦ã„ã¾ã™ï¼** ğŸ‰
